<extend name="Web/companyCom" />
<block name="css_files">
<link rel="stylesheet" href="__PUBLIC__/Business/BusinessCSS/shopIndex/shopIndex.css"></link>

 <link rel="stylesheet" href="__PUBLIC__/JS/module/datenew/css/jquery-ui-1.9.2.custom.css?v=1" type="text/css">
  <style>
            .container{
               border:1px solid #eee;
            }
            .spAnIndex{
              overflow-y:scroll !important;
            }
            .kbShopAdmin_box{

                border-bottom: 1px solid #eee;
                padding-bottom: 10px;
            }
       </style>
</block>
<block name="content" >
	<div id="kbShopAdmin_rightCenter" class="spAnIndex ">
		<div class="kbShopAdmin_box">
	          <div class="centerTitle">
	            <h2>访问量统计</h2>
	          </div>
	        <div class="kbShopAdmin_operating filter-operating" >
	          <form>
	            <div class="filterData">
	            <input type="text" class="ui-datepicker-time" readonly="readonly"  value="" />
	            <input class="start" type="hidden" name="start" value="" />
	            <input  class="end"  type="hidden" name="end" value="" />
	            <button class="kbShopAdmin_opt w80 h30" type="button">确定</button>
	            </div>
	          </form>
	        </div>
	       <div id="container" class="container" style="height: 300px"></div>
	      </div>


	      <div class="kbShopAdmin_box">
	          <div class="centerTitle">
	            <h2>销售统计</h2>
	          </div>
	        <div class="kbShopAdmin_operating filter-operating" >
	          <form>
	            <div class="filterData">
	            <input type="text" class="ui-datepicker-time" readonly="readonly"  value="" />
	            <input class="start" type="hidden" name="start" value="" />
	            <input  class="end"  type="hidden" name="end" value="" />
	            <button class="kbShopAdmin_opt w80 h30" type="button">确定</button>
	            </div>
	          </form>
	        </div>
	       <div id="container2" class="container" style="height: 300px"></div>
	      </div>

	      <div class="kbShopAdmin_box">
	          <div class="centerTitle">
	            <h2>新增用户统计</h2>
	          </div>
	        <div class="kbShopAdmin_operating filter-operating" >
	          <form>
	            <div class="filterData">
	            <input type="text" class="ui-datepicker-time" readonly="readonly"  value="" />
	            <input class="start" type="hidden" name="start" value="" />
	            <input  class="end"  type="hidden" name="end" value="" />
	            <button class="kbShopAdmin_opt w80 h30" type="button">确定</button>
	            </div>
	          </form>
	        </div>
	       <div id="container3" class="container" style="height: 300px"></div>
	      </div>

	      <div class="kbShopAdmin_box">
	          <div class="centerTitle">
	            <h2>官网菜单浏览统计</h2>
	          </div>
	        <div class="kbShopAdmin_operating filter-operating" >
	          <form>
	            <div class="filterData">
	            <input type="text" class="ui-datepicker-time" readonly="readonly"  value="" />
	            <input class="start" type="hidden" name="start" value="" />
	            <input  class="end"  type="hidden" name="end" value="" />
	            <button class="kbShopAdmin_opt w80 h30" type="button">确定</button>
	            </div>
	          </form>
	        </div>
	       <div id="container4" class="container" style="height: 300px"></div>
	      </div>
	      <!--  <div id="container2" style="height: 100%"></div>
	       <div id="container3" style="height: 100%"></div>
	       <div id="container4" style="height: 100%"></div> -->
	   </div>
	      
	   <div class="ui-datepicker-css">  
	      <div class="ui-datepicker-quick">
	          <p>快捷日期<a class="ui-close-date">X</a></p>
	          <div>
	              <input class="ui-date-quick-button" type="button" value="今天" alt="0"  name=""/>
	              <input class="ui-date-quick-button" type="button" value="昨天" alt="-1" name=""/>
	              <input class="ui-date-quick-button" type="button" value="7天内" alt="-6" name=""/>
	              <input class="ui-date-quick-button" type="button" value="14天内" alt="-13" name=""/>
	              <input class="ui-date-quick-button" type="button" value="30天内" alt="-29" name=""/>
	              <input class="ui-date-quick-button" type="button" value="60天内" alt="-59" name=""/>
	          </div>
	      </div>
	      <div class="ui-datepicker-choose">
	            <p>自选日期</p>
	            <div class="ui-datepicker-date">
	                <input name="startDate" id="startDate" class="startDate" readonly value="2014/12/20" type="text">
	               -
	                <input name="endDate" id="endDate" class="endDate" readonly  value="2014/12/20" type="text" disabled onChange="datePickers()">
	            
	            </div>
	        </div>
	    </div>
	  </div>
	</div>

</block>
<block name="js_files">

  <script type="text/javascript" src="__PUBLIC__/JS/module/datenew/js/jquery-ui-1.9.2.custom.js"></script>

  <script type="text/javascript" src="__PUBLIC__/JS/module/datenew/js/share.js?v=1.11"></script>


   <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts-all-3.js"></script>
   <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
   <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
   <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
   <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
   <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
   <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
  <script type="text/javascript">
    window.onload=function(){
      //访问量统计
     
      	function getFirstTableData(start,end){

      		$.get('{{:U("ajaxControl")}}',{
      			flag:"getFirstTableData",
      			start:start,
      			end:end
      		},function(res){
      			var newDate=new Array();
      			res.date.map(function(elem,indexs){
      				console.log(elem)
      				newDate.push(date('Y-m-d',elem));
      			})
      			
      			var dom = document.getElementById("container");
      			var myChart = echarts.init(dom);
      			var app = {};
      			var option = null;
      			option = {
      			    title: {
      			        text: ''
      			    },
      			    tooltip: {
      			        trigger: 'axis'
      			    },
      			    // legend: {
      			    //     data:['邮件营销','联盟广告','视频广告','直接访问','搜索引擎']
      			    // },
      			    grid: {
      			        left: '3%',
      			        right: '4%',
      			        bottom: '3%',
      			        containLabel: true
      			    },
      			    toolbox: {
      			        feature: {
      			            saveAsImage: {}
      			        }
      			    },
      			    xAxis: {//横坐标
      			        type: 'category',
      			        boundaryGap: false,
      			        data: newDate
      			    },
      			    yAxis: {//纵坐标
      			        type: 'value'
      			    },
      			    series: [
      			        {
      			            name:'访问量',
      			            type:'line',
      			            data:res.visit_total
      			        }
      			       
      			    ]
      			};
      			
      			if (option && typeof option === "object") {
      			    myChart.setOption(option, true);
      			}
      		})

      	}
      


       
    
       //销售统计
      
       	function getSecondTableData(start,end){
       		var data=new Object();
      		$.get('{{:U("ajaxControl")}}',{
      			flag:"getSecondTableData",
      			start:start,
      			end:end
      		},function(res){
      			
      			data=res;
      			var newDate=new Array();
      			data.date.map(function(elem,indexs){
      				newDate.push(date('Y-m-d',elem));
      			})
	      		var dom = document.getElementById("container2");
		        var myChart = echarts.init(dom);
		        var app = {};
		        var option = null;
		        option = {
		            title: {
		                text: ''
		            },
		            tooltip: {
		                trigger: 'axis'
		            },
		            legend: {//
		                data:['订单量']
		            },
		            grid: {
		                left: '3%',
		                right: '4%',
		                bottom: '3%',
		                containLabel: true
		            },
		            toolbox: {
		                feature: {
		                    saveAsImage: {}
		                }
		            },
		            xAxis: {
		                type: 'category',
		                boundaryGap: false,
		                data: newDate
		            },
		            yAxis: {
		                type: 'value'
		            },
		            series: [
		               
		                {
		                    name:'订单量',
		                    type:'line',
		                    
		                    data:data.OrderForm
		                }
		               
		            ]
		        };
		        
		        if (option && typeof option === "object") {
		            myChart.setOption(option, true);
		        }
      		})
      		
      	}
      
      	
        
    
      //新增用户统计
      
       	function getThirdTableData(start,end){
       		var data=new Object();
      		$.get('{{:U("ajaxControl")}}',{
      			flag:"getThirdTableData",
      			start:start,
      			end:end
      		},function(res){
      			console.log(res);
      			// data=res;
      			var newDate=new Array();
       				res.date.map(function(elem,indexs){
       					newDate.push(date('Y-m-d',elem));
       				})
      			var dom = document.getElementById("container3");
      			var myChart = echarts.init(dom);
      			var app = {};
      			var option = null;
      			option = {
      			    title: {
      			        text: ''
      			    },
      			    tooltip: {
      			        trigger: 'axis'
      			    },
      			    // legend: {
      			    //     data:['邮件营销','联盟广告','视频广告','直接访问','搜索引擎']
      			    // },
      			    grid: {
      			        left: '3%',
      			        right: '4%',
      			        bottom: '3%',
      			        containLabel: true
      			    },
      			    toolbox: {
      			        feature: {
      			            saveAsImage: {}
      			        }
      			    },
      			    xAxis: {
      			        type: 'category',
      			        boundaryGap: false,
      			        data:newDate
      			    },
      			    yAxis: {
      			        type: 'value'
      			    },
      			    series: [
      			        {
      			            name:'用户',
      			            type:'line',
      			            data:res.data
      			        }
      			        
      			    ]
      			};
      			
      			if (option && typeof option === "object") {
      			    myChart.setOption(option, true);
      			}
      		});
      	}
      	
     
       
     
      //官网菜单浏览统计
      
       	 	function getFortTableData(start,end){
       			$.get('{{:U("ajaxControl")}}',{
       				flag:"getFortTableData",
       				start:start,
       				end:end
       			},function(res){
       				console.log(res);
       				var newDate=new Array();
       				res.date.map(function(elem,indexs){
       					newDate.push(date('Y-m-d',elem));
       				})
	       			var dom = document.getElementById("container4");
	       			var myChart = echarts.init(dom);
	       			var app = {};
	       			var option = null;
	       			option = {
	       			    title: {
	       			        text: ''
	       			    },
	       			    tooltip: {
	       			        trigger: 'axis'
	       			    },
	       			    legend: {
	       			        data:['首页点击量','动态点击量','商品点击量','我的点击量']
	       			    },
	       			    grid: {
	       			        left: '3%',
	       			        right: '4%',
	       			        bottom: '3%',
	       			        containLabel: true
	       			    },
	       			    toolbox: {
	       			        feature: {
	       			            saveAsImage: {}
	       			        }
	       			    },
	       			    xAxis: {
	       			        type: 'category',
	       			        boundaryGap: false,
	       			        data: newDate
	       			    },
	       			    yAxis: {
	       			        type: 'value'
	       			    },
	       			    series: [
	       			        {
	       			            name:'首页点击量',
	       			            type:'line',
	       			            data:res.click_total[1]
	       			        },
	       			        {
	       			            name:'动态点击量',
	       			            type:'line',
	       			            data:res.click_total[2]
	       			        },
	       			        {
	       			            name:'商品点击量',
	       			            type:'line',
	       			            data:res.click_total[3]
	       			        },
	       			      
	       			        {
	       			            name:'我的点击量',
	       			            type:'line',
	       			            data:res.click_total[5]
	       			        }
	       			    ]
	       			};
	       			if (option && typeof option === "object") {
	       			    myChart.setOption(option, true);
	       			}
       			})
       		}

       		
       		
       		
	    (function(){
	     	var nowDate = new Date(),
	     		end=Date.parse(new Date(nowDate.getFullYear() + '/'+  (nowDate.getMonth()+1) + '/' + nowDate.getDate()));
	     		nowDate.setDate(nowDate.getDate()-parseInt(7));
	     		var start =Date.parse( nowDate.getFullYear() + '/'+  (nowDate.getMonth()+1) + '/' + nowDate.getDate());
	     		getFirstTableData(start,end);
	      		getSecondTableData(start,end);
	     		getThirdTableData(start,end);
	     		getFortTableData(start,end);
	     })();
      	$('.filterData .kbShopAdmin_opt' ).on('click',function(){
      		var $this=$(this),
      			filterData=$('.filterData .kbShopAdmin_opt' ),
      			start=$this.siblings('[name="start"]').val().trim(),
      			end=$this.siblings('[name="end"]').val().trim(),
      			indexs=filterData.index($this);
      			
      			switch(indexs){
      				case 0:
      					getFirstTableData(start,end)
      				break;
      				case 1:
      					getSecondTableData(start,end);
      				break;
      				case 2:
      					getThirdTableData(start,end);
      				break;
      				case 3:
      					getFortTableData(start,end);
      				break;
      			}
      	});
    
    }

  </script>	

</block>